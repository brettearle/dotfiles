##### PREFIX & INDEXING #####

# Use C-a as prefix instead of C-b
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Start windows and panes at 1
set -g base-index 1
setw -g pane-base-index 1


##### WINDOW / PANE BEHAVIOUR #####

# New windows/panes start in the current pane's directory
bind c  new-window      -c "#{pane_current_path}"
bind '"' split-window   -c "#{pane_current_path}"
bind %  split-window -h -c "#{pane_current_path}"

# Disable automatic renaming so names stay as you set them
set -g allow-rename off
set -g automatic-rename off

# Simple window titles: only show window name (nvim, term, claude, etc.)
setw -g window-status-format " #W "
setw -g window-status-current-format " #W "

# Pane index + path in pane borders
set -g pane-border-format "#{pane_index} #{pane_current_path}"

# Vi-style keys in copy mode
setw -g mode-keys vi


##### TERMINAL & INPUT #####

# Mouse support
set -g mouse on

# Default terminal
set -g default-terminal "xterm-256color"


##### BROWSER PLUGIN SETTINGS #####

set -g @new_browser_window 'google-chrome --new-window'
set -g @browser_session_dir '$HOME/.tmux/browser-sessions'


##### STATUS BAR & CATPPUCCIN #####

# Status bar position
set -g status-position top

# Load catppuccin theme (installed manually)
run '~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux'

# Catppuccin settings
set -g @catppuccin_flavor "mocha"
set -g @catppuccin_window_status_style "rounded"

# Use only window name for tabs
set -g @catppuccin_window_text " #W "
set -g @catppuccin_window_current_text " #W "

# Status bar lengths
set -g status-right-length 100
set -g status-left-length 100

# Left side empty (catppuccin likes to control layout)
set -g status-left ""

# Right side status segments (catppuccin modules)
set -g status-right "#{E:@catppuccin_status_application}"
set -agF status-right "#{E:@catppuccin_status_cpu}"
set -ag  status-right "#{E:@catppuccin_status_session}"
set -ag  status-right "#{E:@catppuccin_status_uptime}"
set -agF status-right "#{E:@catppuccin_status_battery}"

##### PLUGINS (TPM) #####

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'alexwforsythe/tmux-which-key'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'ofirgall/tmux-browser'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'

# Initialize TPM (keep this at the bottom of the plugin list)
run '~/.tmux/plugins/tpm/tpm'

##### FINAL WINDOW FORMAT WITH LAVENDER ACTIVE + DARK PURPLE INACTIVE #####

# Stop all renaming (keeps your chosen names)
set -g allow-rename off
set -g automatic-rename off
setw -g automatic-rename off

# Active window number background (dark purple)
set -g @win_index_bg_active "darkmagenta"
set -g @win_index_fg_active "white"

# Inactive window number background (lavender)
set -g @win_index_bg_inactive "#b4befe"
set -g @win_index_fg_inactive "black"

# Inactive window format
setw -g window-status-format \
  "#[fg=#{@win_index_fg_inactive},bg=#{@win_index_bg_inactive}]  #I  #[default] #W "

# Active window format
setw -g window-status-current-format \
  "#[fg=#{@win_index_fg_active},bg=#{@win_index_bg_active},bold]  #I  #[default] #W "

# If no session exists, create one with 3 windows automatically
if-shell '[[ $(tmux ls 2>/dev/null | wc -l) -eq 0 ]]' \
  'new-session -d -s main -n nvim "nvim" ; \
   new-window  -t main:2 -n zsh "zsh" ; \
   new-window  -t main:3 -n serv "zsh" ; \
   select-window -t main:1'
